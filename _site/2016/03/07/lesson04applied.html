<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Lesson 04 - NumPy and pandas</title>
  <meta name="description" content="Lesson 04 - NumPy and pandas">

  <link rel="stylesheet" href="/pythoncourse/css/main.css">
  <link rel="canonical" href="http://jeremy.kiwi.nz/pythoncourse/pythoncourse/2016/03/07/lesson04applied.html">
  <link rel="alternate" type="application/rss+xml" title="Python @ Precima" href="http://jeremy.kiwi.nz/pythoncourse/pythoncourse/feed.xml">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/pythoncourse/">Python @ Precima</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
        
          
        
          
        
          
          <a class="page-link" href="/pythoncourse/tag/Applied%20Statistics%20stream/">Applied Statistics stream</a>
          
        
          
          <a class="page-link" href="/pythoncourse/tag/R&D%20stream/">R&D stream</a>
          
        
      </div>
    </nav>

  </div>

</header>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-73837623-1', 'auto');
  ga('send', 'pageview');

</script>

    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Lesson 04 - NumPy and pandas</h1>
    <p class="post-meta"><time datetime="2016-03-07T00:00:00-05:00" itemprop="datePublished">Mar 7, 2016</time> • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Jeremy</span></span></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <h2 id="lesson-04---numpy-and-pandas">Lesson 04 - NumPy and pandas</h2>

<p>So far we have covered the base Python environment - built in data types and
structures, and looked at how we can use Python as a general purpose programming
language.</p>

<p>Now we will hone in on our goal of data science - using the data science modules
developed by the data science community. Download todays <a href="/pythoncourse/assets/applied/Lesson - 04.ipynb">notebook
here</a>.</p>

<p>This lesson and the next lesson are based on the book <a href="http://shop.oreilly.com/product/0636920023784.do">Python for data
analysis</a>, by Wes McKinney,
the primary developer of pandas. Feel free to go without the book - we will
cover much of its content in the class, and it is a little outdated.</p>

<p>The first module we will examine is NumPy and we will the move onto pandas.
NumPy provides arrays, while pandas provides DataFrames.</p>

<h3 id="numpy">NumPy</h3>

<p>NumPy stands for numerical Python. So far the Python data structures have
worked, but have not been tailored for large scale data analysis.</p>

<p>Think of how Python works under the hood when multiplying every element of a
list by 2:</p>

<p><strong>In [1]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">l</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="c">#probably not what we want as statisticians!</span>
<span class="k">print</span><span class="p">([</span><span class="n">i</span> <span class="o">*</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">l</span><span class="p">])</span>
<span class="c">#this works, but what about -</span>
<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="s">'a'</span><span class="p">]</span>
<span class="k">print</span><span class="p">([</span><span class="n">i</span> <span class="o">*</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">l</span><span class="p">])</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>[1, 2, 3, 4, 5, 1, 2, 3, 4, 5]
[2, 4, 6, 8, 10]
[2, 4, 6, 8, 'aa']
</code></pre>
</div>

<p>Python needs to check each data type to find the times method associated with
it. In small examples like this, the overhead is very low, but when we are
dealing with millions of rows, it quickly adds up.</p>

<p>To work better with numeric (or other large scale data), numpy introduces the
array, a data structure which may only contain one type of data:</p>

<p><strong>In [9]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>[ 2  4  6  8 10]
</code></pre>
</div>

<p>It is also much faster (by a process called vectorisation):</p>

<p><strong>In [3]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">l</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="o">%</span><span class="n">timeit</span> <span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">l</span><span class="p">]</span>
<span class="o">%</span><span class="n">timeit</span> <span class="n">k</span> <span class="o">*</span> <span class="mi">2</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>100 loops, best of 3: 2.1 ms per loop
10000 loops, best of 3: 57.6 µs per loop
</code></pre>
</div>

<p>As well as the array data type, numpy contains broadcasting methods, built in
functions utilising the array structure to work extremely fast (by going through
C), linear algebra, random numbers and good integration into C and Fortran code</p>

<h3 id="numpy--basics">NumPy  basics</h3>

<p>The array is a new class, with a lot of its own methods. The exact
implementation is outside the scope of the class, take a look at the <a href="http://www.numpy.org/">NumPy
website</a> for source code and official documentation.</p>

<p>Technically, we use the np.array to create an instance of class ndarray. I’ll
refer to them as arrays in this lesson.</p>

<p>We can access the type of data contained in an array:</p>

<p><strong>In [4]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sctypes</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>int64
{'float': [&lt;class 'numpy.float16'&gt;, &lt;class 'numpy.float32'&gt;, &lt;class 'numpy.float64'&gt;, &lt;class 'numpy.float128'&gt;], 'others': [&lt;class 'bool'&gt;, &lt;class 'object'&gt;, &lt;class 'str'&gt;, &lt;class 'str'&gt;, &lt;class 'numpy.void'&gt;], 'complex': [&lt;class 'numpy.complex64'&gt;, &lt;class 'numpy.complex128'&gt;, &lt;class 'numpy.complex256'&gt;], 'int': [&lt;class 'numpy.int8'&gt;, &lt;class 'numpy.int16'&gt;, &lt;class 'numpy.int32'&gt;, &lt;class 'numpy.int64'&gt;], 'uint': [&lt;class 'numpy.uint8'&gt;, &lt;class 'numpy.uint16'&gt;, &lt;class 'numpy.uint32'&gt;, &lt;class 'numpy.uint64'&gt;]}
</code></pre>
</div>

<p>We can initialise arrays in a number of ways</p>

<p><strong>In [8]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#empty - uninitialised, random numbers!</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="c">#all zeros</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">)))</span>
<span class="c">#from a list</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]))</span>
<span class="c">#arange is the numpy version of range - gives an array</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>[[[  6.90469329e-310   2.13249800e-316]
  [  0.00000000e+000   0.00000000e+000]
  [  0.00000000e+000   8.60952352e-072]]

 [[  4.46535817e-090   1.39938874e-076]
  [  1.55075695e+184   1.43927482e+160]
  [  3.99910963e+252   2.32204073e-056]]]
[[ 0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.]]
[1 2 3 5]
[0 1 2 3 4 5 6 7 8 9]
</code></pre>
</div>

<p><strong>In [205]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#can specify data type</span>
<span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="c">#and cast it:</span>
<span class="n">arr1</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="c">#changing type copies, rather than modifies in place</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>array([1, 2, 3])
</code></pre>
</div>

<p><strong>In [25]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#numpy is vectorized!</span>
<span class="k">print</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span> <span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="c">#we do this by broadcasting....</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>[1, 2, 3, 4, 1, 2, 3, 4]
[2 4 6 8]
</code></pre>
</div>

<p><strong>In [10]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]))</span>
<span class="c">#times, / etc</span>
<span class="c">#this is not matrix multiplication!!</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]]))</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>[ 1  4  9 16]
[[ 1  4]
 [ 9 25]]
</code></pre>
</div>

<h3 id="subsetting">Subsetting</h3>

<p>We can subset much like lists, with the addition of broadcasting for assignment</p>

<p><strong>In [217]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">l</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="k">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="c">#error!</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span> <span class="c">#broadcasting</span>
<span class="k">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>---------------------------------------------------------------------------

TypeError                                 Traceback (most recent call last)

&lt;ipython-input-217-3d54943f2f76&gt; in &lt;module&gt;()
      1 l = list(range(10))
----&gt; 2 l[2:5] = 3
      3 print(l)
      4 #error!
      5 l = np.arange(10)


TypeError: can only assign an iterable
</code></pre>
</div>

<p>We need to be careful about assigning slices:</p>

<p><strong>In [218]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#linked! reference</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">l_slice</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
<span class="n">l_slice</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">4</span>
<span class="k">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="c">#use .copy()</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>[0 1 2 3 4 4 4 4 8 9]
</code></pre>
</div>

<p>We can make 2d and 3,4,5… matrices using nested lists, and subset them
appropriately:</p>

<p><strong>In [13]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#nested lists are made to be 2d</span>
<span class="n">arr2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<span class="k">print</span><span class="p">(</span><span class="n">arr2d</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">arr2d</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
<span class="n">arr2d</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="n">arr2d</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">arr2d</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">2</span><span class="p">:]</span>
<span class="n">arr2d</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">:]</span>
<span class="c">#multid</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]],[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]])</span>
<span class="k">print</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
<span class="c">#broadcasting - must match or be one in each dimension!</span>
<span class="n">arr</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]]])</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>(3, 3)
2
(2, 3, 3)
3





array([[[ 1,  4,  9],
        [16, 25, 36],
        [49, 64, 81]],

       [[ 1,  4,  9],
        [16, 25, 36],
        [49, 64, 81]]])
</code></pre>
</div>

<p><strong>In [30]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#on multi dimensional arrays, we can use axis calls to do things by rows or columns:</span>
<span class="n">arr2d</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>
<span class="n">arr2d</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">arr2d</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>array([ 6, 15, 24])
</code></pre>
</div>

<p>We don’t need filter: We can subset with booleans much like R:</p>

<p><strong>In [17]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#no filter, just use booleans</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="c">#could have done from numpy import random</span>
<span class="n">l</span><span class="p">[</span><span class="n">l</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">k</span><span class="p">[</span><span class="n">l</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="c">#arbitrary computation!</span>
<span class="c">#works on 2d</span>
<span class="n">arr2d</span><span class="p">[</span><span class="n">arr2d</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">]</span>
<span class="c">#or just get the booleans:</span>
<span class="n">arr2d</span> <span class="o">&gt;</span> <span class="mi">3</span>
<span class="c">#and by assignment</span>
<span class="n">arr2d</span><span class="p">[</span><span class="n">arr2d</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">arr2d</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>array([[1, 2, 3],
       [0, 0, 0],
       [0, 0, 0]])
</code></pre>
</div>

<p>We can subset to rearrange:</p>

<p><strong>In [53]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
<span class="n">arr</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>array([[ 0.,  0.,  0.,  0.],
       [ 1.,  1.,  1.,  1.],
       [ 2.,  2.,  2.,  2.],
       [ 3.,  3.,  3.,  3.],
       [ 4.,  4.,  4.,  4.],
       [ 5.,  5.,  5.,  5.],
       [ 6.,  6.,  6.,  6.],
       [ 7.,  7.,  7.,  7.]])
</code></pre>
</div>

<p><strong>In [244]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">arr</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>
<span class="n">arr</span><span class="p">[[</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">]]</span>
<span class="c">#negative to start at end</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>array([[ 7.,  7.,  7.,  7.],
       [ 5.,  5.,  5.,  5.]])
</code></pre>
</div>

<p><strong>In [246]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#np.where</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">30</span><span class="p">,</span>  <span class="mi">80</span><span class="p">,</span> <span class="mi">130</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">430</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">130</span><span class="p">,</span> <span class="mi">430</span><span class="p">,</span> <span class="mi">730</span><span class="p">]])</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">50</span><span class="p">,</span>  <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">245</span><span class="p">,</span> <span class="mi">420</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">110</span><span class="p">,</span> <span class="mi">490</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">j</span> <span class="o">=</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">k</span>
<span class="n">j</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>array([[False, False,  True],
       [ True,  True,  True],
       [ True, False,  True]], dtype=bool)
</code></pre>
</div>

<p><strong>In [248]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>array([[ 50,  90, 130],
       [ 80, 255, 430],
       [130, 490, 730]])
</code></pre>
</div>

<p><strong>In [249]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#or, using broadcasting</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">l</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>array([[ 0.43077853,  0.        ,  2.18006544,  0.        ,  0.99805323],
       [ 0.62200891,  0.        ,  1.51734812,  0.        ,  0.4610735 ],
       [ 0.35047453,  0.78169552,  0.        ,  1.40064949,  0.        ],
       [ 0.62944507,  0.        ,  0.        ,  0.        ,  0.        ]])
</code></pre>
</div>

<h3 id="reshape-and-matrix-methods">Reshape and Matrix methods</h3>

<p>Using the built in linear algebra methods, we can carry out matrix operations
easily.</p>

<p>We will endeavour to cover more matrix algebra in a lesson including sympy,
sciPy and linear optimization.</p>

<p>Reshape allows us to reshape our matrices:</p>

<p><strong>In [61]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#reshape</span>
<span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>array([[ 0,  1,  2,  3,  4],
       [ 5,  6,  7,  8,  9],
       [10, 11, 12, 13, 14]])
</code></pre>
</div>

<p><strong>In [65]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># .T transposes a matrix</span>
<span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">T</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>array([[ 0,  5, 10],
       [ 1,  6, 11],
       [ 2,  7, 12],
       [ 3,  8, 13],
       [ 4,  9, 14]])
</code></pre>
</div>

<p><strong>In [70]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#matrix multiplication</span>
<span class="c">#not</span>
<span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="c">#this is elementwise, not useful</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>array([[  0,   1,   4,   9,  16],
       [ 25,  36,  49,  64,  81],
       [100, 121, 144, 169, 196]])
</code></pre>
</div>

<p><strong>In [14]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#use np.dot for matrix operations</span>
<span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>array([[ 30,  80, 130],
       [ 80, 255, 430],
       [130, 430, 730]])
</code></pre>
</div>

<p><strong>In [18]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1000000</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10000</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>array([[-1724114088,     9679576,  1743473240, ..., -1049853224,
          683940440, -1877233192],
       [    9679576,  1016093272,  2022506968, ..., -1152439720,
         -146026024,   860387672],
       [ 1743473240,  2022506968, -1993426600, ..., -1255026216,
         -975992488,  -696958760],
       ...,
       [-1049853224, -1152439720, -1255026216, ...,  1884158552,
         1781572056,  1678985560],
       [  683940440,  -146026024,  -975992488, ...,  1781572056,
          951605592,   121639128],
       [-1877233192,   860387672,  -696958760, ...,  1678985560,
          121639128, -1435707304]])
</code></pre>
</div>

<p>NumPy has the expected array of matrix functions, implemented in standard C or
fortran code. See the <a href="https://docs.scipy.org/doc/numpy/reference/routines.linalg.html">website
documentation</a>
for examples. Some of the functions are in the linalg submodule:</p>

<p><strong>In [18]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">linalg</span> <span class="k">as</span> <span class="n">LA</span>
<span class="n">w</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">LA</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">v</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>[[1 0 0]
 [0 2 0]
 [0 0 3]]
[ 1.  2.  3.]
[[ 1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0.  1.]]
</code></pre>
</div>

<p><strong>In [20]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#solving:</span>
<span class="c">#5 * x + y = 91 and x + 20 * y = 80</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">91</span><span class="p">,</span><span class="mi">80</span><span class="p">])</span>
<span class="n">LA</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>array([ 17.57575758,   3.12121212])
</code></pre>
</div>

<p>More on linear algebra later in the course</p>

<h3 id="numpy-universal-functions">NumPy universal functions</h3>

<p>NumPy has a number of ‘ufuncs’ built in. These are fast, as they are (mostly)
implemented in C, and are a great choice for carrying out element wise
operations. For the full list, see the <a href="https://docs.scipy.org/doc/numpy/reference/ufuncs.html">official
docs</a></p>

<p><strong>In [253]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">30</span><span class="p">,</span>  <span class="mi">80</span><span class="p">,</span> <span class="mi">130</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">430</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">130</span><span class="p">,</span> <span class="mi">430</span><span class="p">,</span> <span class="mi">730</span><span class="p">]])</span>
<span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="c">#exp, abs etc</span>
<span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>array([  80.,  255.,  430.])
</code></pre>
</div>

<p>We have two main classes of ufuncs, unary, which operate on one array, and
binary which operate on two:</p>

<p><strong>In [19]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#binary ufuncs:</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">30</span><span class="p">,</span>  <span class="mi">80</span><span class="p">,</span> <span class="mi">130</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">430</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">130</span><span class="p">,</span> <span class="mi">430</span><span class="p">,</span> <span class="mi">730</span><span class="p">]])</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">50</span><span class="p">,</span>  <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">245</span><span class="p">,</span> <span class="mi">420</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">110</span><span class="p">,</span> <span class="mi">490</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">k</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>array([[ 50,  90, 130],
       [ 80, 255, 430],
       [130, 490, 730]])
</code></pre>
</div>

<p>We can write our own ufuncs using <code class="highlighter-rouge">frompyfunc</code>. The main benefit of this is to
allow broadcasting instead of having to use a loop:</p>

<p><strong>In [27]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">myfun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="nb">oct</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="n">myfun</span><span class="p">(</span><span class="n">l</span><span class="p">))</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>---------------------------------------------------------------------------

TypeError                                 Traceback (most recent call last)

&lt;ipython-input-27-423e7f25fa0f&gt; in &lt;module&gt;()
      2     return(oct(x))
      3
----&gt; 4 print(myfun(l))


&lt;ipython-input-27-423e7f25fa0f&gt; in myfun(x)
      1 def myfun(x):
----&gt; 2     return(oct(x))
      3
      4 print(myfun(l))


TypeError: only integer arrays with one element can be converted to an index
</code></pre>
</div>

<p><strong>In [28]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">myfun2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frompyfunc</span><span class="p">(</span><span class="n">myfun</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">myfun2</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>array([['0o36', '0o120', '0o202'],
       ['0o120', '0o377', '0o656'],
       ['0o202', '0o656', '0o1332']], dtype=object)
</code></pre>
</div>

<h3 id="reading-in-data">Reading in data</h3>

<p>pandas <code class="highlighter-rouge">read_csv</code> function is much easier, but as a stop gap, and to keep the
numbers in NumPy, we can use NumPys built in csv reader. You can see the
<a href="https://docs.scipy.org/doc/numpy/user/basics.io.genfromtxt.html">offical docs
here</a></p>

<p><strong>In [25]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s">'http://www.jeremy.kiwi.nz/pythoncourse/assets/data/data.txt'</span><span class="p">,</span>
              <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
              <span class="n">missing_values</span><span class="o">=</span><span class="p">(</span><span class="s">'MISSING'</span><span class="p">,</span><span class="s">'MISSING'</span><span class="p">,</span><span class="s">'MISSING'</span><span class="p">),</span>
              <span class="n">filling_values</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">999</span><span class="p">,</span><span class="o">-</span><span class="mi">999</span><span class="p">,</span><span class="o">-</span><span class="mi">999</span><span class="p">))</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>array([[  4.83900000e-01,   4.53600000e-01,   3.56100000e-01],
       [  1.29200000e-01,   6.87500000e-01,  -9.99000000e+02],
       [  1.78100000e-01,   3.04900000e-01,   8.92800000e-01],
       [ -9.99000000e+02,   5.80100000e-01,   2.03800000e-01],
       [  5.99300000e-01,   4.35700000e-01,   7.41000000e-01]])
</code></pre>
</div>

<h3 id="numpy-summary">NumPy Summary</h3>

<p>NumPy is a large library - we haven’t touched on its sorting, sets, or random
number generations capabilities. However, as pandas is based on NumPy arrays, we
will continue to cover it’s functionality here.</p>

<p>Here is a quick overview of the example given in the install instructions:</p>

<p><strong>In [104]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="n">steps</span><span class="p">,</span> <span class="n">repeats</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span>
<span class="n">stepstaken</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">repeats</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stepstaken</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">));</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'time'</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'position'</span><span class="p">);</span></code></pre></figure>

<p><img src="/pythoncourse/assets/images/lesson---03_45_0.png" alt="png" /></p>

<h2 id="pandas">pandas</h2>

<p>pandas, short for Python and data analysis (or panel datasets) was created by
Wes McKinney, while he was working as a financial analyst (amongst other
projects, he is currently working for Apache to get <a href="http://wesmckinney.com/blog/pandas-and-apache-arrow/">pandas to work with the
Apache Arrow format</a>). He
initially began it as a port of R into Python for speed, but quickly diverged
into a slightly different model.</p>

<p>It is primarily made for time series and tabular data, and its main point of use
are the new classes, DataFrame and Series, modelled on Rs dataframe.</p>

<p><strong>In [2]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">Series</span><span class="p">,</span> <span class="n">DataFrame</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span></code></pre></figure>

<h3 id="series">Series</h3>

<p>Series are effectively NumPy arrays, but with an added index, which is retained
through operations:</p>

<p><strong>In [107]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">obj</span> <span class="o">=</span> <span class="n">Series</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
<span class="n">obj</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>0     3
1     6
2     9
3    12
dtype: int64
</code></pre>
</div>

<p><strong>In [256]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#series are arrays, with an index:</span>
<span class="n">obj</span><span class="o">.</span><span class="n">values</span>
<span class="n">obj</span><span class="o">.</span><span class="n">index</span>
<span class="c">#indexes are immutable!</span>
<span class="n">obj</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>---------------------------------------------------------------------------

TypeError                                 Traceback (most recent call last)

&lt;ipython-input-256-1f81be84565f&gt; in &lt;module&gt;()
      3 obj.index
      4 #indexes are immutable!
----&gt; 5 obj.index[1] = 5


C:\Anaconda3\lib\site-packages\pandas\core\index.py in __setitem__(self, key, value)
   1128
   1129     def __setitem__(self, key, value):
-&gt; 1130         raise TypeError("Index does not support mutable operations")
   1131
   1132     def __getitem__(self, key):


TypeError: Index does not support mutable operations
</code></pre>
</div>

<p>You can think of a Series, as a fixed length, ordered dict, and we can easily
convert a dict to a Series:</p>

<p><strong>In [111]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">sdata</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Ohio'</span><span class="p">:</span> <span class="mi">35000</span><span class="p">,</span> <span class="s">'Texas'</span><span class="p">:</span> <span class="mi">71000</span><span class="p">,</span> <span class="s">'Oregon'</span><span class="p">:</span> <span class="mi">16000</span><span class="p">,</span> <span class="s">'Utah'</span><span class="p">:</span> <span class="mi">5000</span><span class="p">}</span>
<span class="n">Series</span><span class="p">(</span><span class="n">sdata</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>Ohio      35000
Oregon    16000
Texas     71000
Utah       5000
dtype: int64
</code></pre>
</div>

<p><strong>In [259]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#or:</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">Series</span><span class="p">([</span><span class="mi">35000</span><span class="p">,</span><span class="mi">71000</span><span class="p">,</span><span class="mi">16000</span><span class="p">,</span><span class="mi">5000</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'Ohio'</span><span class="p">,</span><span class="s">'Texas'</span><span class="p">,</span><span class="s">'Oregon'</span><span class="p">,</span><span class="s">'Utah'</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="c">#indices must be unique~!</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>Ohio      35000
Texas     71000
Oregon    16000
Utah       5000
dtype: int64
</code></pre>
</div>

<p><strong>In [118]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#subsetting by index</span>
<span class="n">l</span><span class="p">[</span><span class="s">'Ohio'</span><span class="p">]</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>35000
</code></pre>
</div>

<p><strong>In [120]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#can use all our numpy stuff! And retain our indexes</span>
<span class="n">l</span><span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;</span> <span class="mi">30000</span><span class="p">]</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>Ohio     35000
Texas    71000
dtype: int64
</code></pre>
</div>

<p><strong>In [260]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#reindex with index, fills as NaN</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'Ohio'</span><span class="p">,</span><span class="s">'Texas'</span><span class="p">,</span><span class="s">'Oregon'</span><span class="p">,</span><span class="s">'Ontario'</span><span class="p">])</span>
<span class="n">k</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>Ohio       35000
Texas      71000
Oregon     16000
Ontario      NaN
dtype: float64
</code></pre>
</div>

<p><strong>In [132]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#NaN is the NA/missing for pandas!</span>
<span class="n">k</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
<span class="bp">None</span> <span class="o">==</span> <span class="bp">None</span>
<span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>False
</code></pre>
</div>

<p><strong>In [261]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#add - watch, NaN overwrites!</span>
<span class="n">k</span> <span class="o">+</span> <span class="n">l</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>Ohio        70000
Ontario       NaN
Oregon      32000
Texas      142000
Utah          NaN
dtype: float64
</code></pre>
</div>

<h3 id="dataframes">DataFrames</h3>

<p>DataFrames are similar to a dict of a series - technically they are a 2d series
with some linking between levels.</p>

<p>Columns are arrays (must be one data type), and rows are similar to dicts.</p>

<p>However, the row/column mapping is not as strictly enforced as R.</p>

<p><strong>In [3]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">dat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"http://jeremy.kiwi.nz/pythoncourse/assets/tests/r&amp;d/test1data.csv"</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span>
<span class="n">dat</span></code></pre></figure>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TripType</th>
      <th>VisitNumber</th>
      <th>Weekday</th>
      <th>Upc</th>
      <th>ScanCount</th>
      <th>DepartmentDescription</th>
      <th>FinelineNumber</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>30</td>
      <td>7</td>
      <td>Friday</td>
      <td>60538815980</td>
      <td>1</td>
      <td>SHOES</td>
      <td>8931</td>
    </tr>
    <tr>
      <th>2</th>
      <td>30</td>
      <td>7</td>
      <td>Friday</td>
      <td>7410811099</td>
      <td>1</td>
      <td>PERSONAL CARE</td>
      <td>4504</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2238403510</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>3565</td>
    </tr>
    <tr>
      <th>4</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2006613744</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>1017</td>
    </tr>
    <tr>
      <th>5</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2006618783</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>1017</td>
    </tr>
    <tr>
      <th>6</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2006613743</td>
      <td>1</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>1017</td>
    </tr>
    <tr>
      <th>7</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>7004802737</td>
      <td>1</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>2802</td>
    </tr>
    <tr>
      <th>8</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2238495318</td>
      <td>1</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>4501</td>
    </tr>
    <tr>
      <th>9</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2238400200</td>
      <td>-1</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>3565</td>
    </tr>
    <tr>
      <th>10</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>5200010239</td>
      <td>1</td>
      <td>DSD GROCERY</td>
      <td>4606</td>
    </tr>
    <tr>
      <th>11</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>88679300501</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>3504</td>
    </tr>
    <tr>
      <th>12</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>22006000000</td>
      <td>1</td>
      <td>MEAT - FRESH &amp; FROZEN</td>
      <td>6009</td>
    </tr>
    <tr>
      <th>13</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2236760452</td>
      <td>1</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>7</td>
    </tr>
    <tr>
      <th>14</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>88679300501</td>
      <td>-1</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>3504</td>
    </tr>
    <tr>
      <th>15</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2238400200</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>3565</td>
    </tr>
    <tr>
      <th>16</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>3019294203</td>
      <td>1</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>2801</td>
    </tr>
    <tr>
      <th>17</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>72450408840</td>
      <td>1</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>1028</td>
    </tr>
    <tr>
      <th>18</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>25541500000</td>
      <td>2</td>
      <td>DAIRY</td>
      <td>1305</td>
    </tr>
    <tr>
      <th>19</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2310010776</td>
      <td>1</td>
      <td>PETS AND SUPPLIES</td>
      <td>3300</td>
    </tr>
  </tbody>
</table>
</div>

<p><strong>In [4]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># get the column names</span>
<span class="n">dat</span><span class="o">.</span><span class="n">columns</span>
<span class="c">#get the first five rows</span>
<span class="n">dat</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c">#pick out specific columns</span>
<span class="n">DataFrame</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'TripType'</span><span class="p">,</span><span class="s">'VisitNumber'</span><span class="p">])</span>
<span class="c">#same as</span>
<span class="n">dat</span><span class="p">[[</span><span class="s">'TripType'</span><span class="p">,</span><span class="s">'VisitNumber'</span><span class="p">]]</span>
<span class="c">#get one specific column</span>
<span class="n">dat</span><span class="o">.</span><span class="n">TripType</span>
<span class="c">#get one specific column</span>
<span class="n">dat</span><span class="p">[</span><span class="s">'TripType'</span><span class="p">]</span>
<span class="c">#use ix (index) to get the 10th row</span>
<span class="n">dat</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
<span class="c">#add a new column</span>
<span class="n">dat</span><span class="p">[</span><span class="s">'foo'</span><span class="p">]</span><span class="o">=</span><span class="s">"spam"</span>
<span class="c">#using other columns:</span>
<span class="n">dat</span><span class="p">[</span><span class="s">'foo'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dat</span><span class="p">[</span><span class="s">'VisitNumber'</span><span class="p">]</span> <span class="o">+</span> <span class="n">dat</span><span class="p">[</span><span class="s">'ScanCount'</span><span class="p">]</span>
<span class="c">#add a new column with specific values</span>
<span class="n">dat</span><span class="p">[</span><span class="s">'foo'</span><span class="p">]</span><span class="o">=</span><span class="n">Series</span><span class="p">([</span><span class="s">'spam'</span><span class="p">,</span> <span class="s">'more spam'</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span></code></pre></figure>

<p><strong>In [159]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#delete a column</span>
<span class="k">del</span> <span class="n">dat</span><span class="p">[</span><span class="s">'foo'</span><span class="p">]</span>
<span class="c">#'http://pandas.pydata.org/pandas-docs/dev/generated/pandas.DataFrame.html'</span></code></pre></figure>

<p><strong>In [43]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#recall, indexes are immutable?</span>
<span class="c">#how to reindex?</span>
<span class="n">dat</span> <span class="o">=</span> <span class="n">dat</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">dat</span></code></pre></figure>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TripType</th>
      <th>VisitNumber</th>
      <th>Weekday</th>
      <th>Upc</th>
      <th>ScanCount</th>
      <th>DepartmentDescription</th>
      <th>FinelineNumber</th>
      <th>foo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>30</td>
      <td>7</td>
      <td>Friday</td>
      <td>60538815980</td>
      <td>1</td>
      <td>SHOES</td>
      <td>8931</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>30</td>
      <td>7</td>
      <td>Friday</td>
      <td>7410811099</td>
      <td>1</td>
      <td>PERSONAL CARE</td>
      <td>4504</td>
      <td>8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2238403510</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>3565</td>
      <td>10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2006613744</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>1017</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>

<p><strong>In [41]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#can add defaults</span>
<span class="n">dat</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">dat</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">method</span><span class="o">=</span><span class="s">'ffill'</span><span class="p">)</span></code></pre></figure>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TripType</th>
      <th>VisitNumber</th>
      <th>Weekday</th>
      <th>Upc</th>
      <th>ScanCount</th>
      <th>DepartmentDescription</th>
      <th>FinelineNumber</th>
      <th>foo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>30</td>
      <td>7</td>
      <td>Friday</td>
      <td>60538815980</td>
      <td>1</td>
      <td>SHOES</td>
      <td>8931</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>30</td>
      <td>7</td>
      <td>Friday</td>
      <td>7410811099</td>
      <td>1</td>
      <td>PERSONAL CARE</td>
      <td>4504</td>
      <td>8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2238403510</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>3565</td>
      <td>10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2006613744</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>1017</td>
      <td>10</td>
    </tr>
    <tr>
      <th>5</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2006613744</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>1017</td>
      <td>10</td>
    </tr>
    <tr>
      <th>6</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2006613744</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>1017</td>
      <td>10</td>
    </tr>
    <tr>
      <th>7</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2006613744</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>1017</td>
      <td>10</td>
    </tr>
    <tr>
      <th>8</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2006613744</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>1017</td>
      <td>10</td>
    </tr>
    <tr>
      <th>9</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2006613744</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>1017</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>

<p><strong>In [5]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">dat</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dat</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'foo'</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span></code></pre></figure>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TripType</th>
      <th>VisitNumber</th>
      <th>Weekday</th>
      <th>Upc</th>
      <th>ScanCount</th>
      <th>DepartmentDescription</th>
      <th>FinelineNumber</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>30</td>
      <td>7</td>
      <td>Friday</td>
      <td>60538815980</td>
      <td>1</td>
      <td>SHOES</td>
      <td>8931</td>
    </tr>
    <tr>
      <th>2</th>
      <td>30</td>
      <td>7</td>
      <td>Friday</td>
      <td>7410811099</td>
      <td>1</td>
      <td>PERSONAL CARE</td>
      <td>4504</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2238403510</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>3565</td>
    </tr>
    <tr>
      <th>4</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2006613744</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>1017</td>
    </tr>
    <tr>
      <th>5</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2006618783</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>1017</td>
    </tr>
    <tr>
      <th>6</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2006613743</td>
      <td>1</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>1017</td>
    </tr>
    <tr>
      <th>7</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>7004802737</td>
      <td>1</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>2802</td>
    </tr>
    <tr>
      <th>8</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2238495318</td>
      <td>1</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>4501</td>
    </tr>
    <tr>
      <th>9</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2238400200</td>
      <td>-1</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>3565</td>
    </tr>
    <tr>
      <th>10</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>5200010239</td>
      <td>1</td>
      <td>DSD GROCERY</td>
      <td>4606</td>
    </tr>
    <tr>
      <th>11</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>88679300501</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>3504</td>
    </tr>
    <tr>
      <th>12</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>22006000000</td>
      <td>1</td>
      <td>MEAT - FRESH &amp; FROZEN</td>
      <td>6009</td>
    </tr>
    <tr>
      <th>13</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2236760452</td>
      <td>1</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>7</td>
    </tr>
    <tr>
      <th>14</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>88679300501</td>
      <td>-1</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>3504</td>
    </tr>
    <tr>
      <th>15</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2238400200</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>3565</td>
    </tr>
    <tr>
      <th>16</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>3019294203</td>
      <td>1</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>2801</td>
    </tr>
    <tr>
      <th>17</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>72450408840</td>
      <td>1</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>1028</td>
    </tr>
    <tr>
      <th>18</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>25541500000</td>
      <td>2</td>
      <td>DAIRY</td>
      <td>1305</td>
    </tr>
    <tr>
      <th>19</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2310010776</td>
      <td>1</td>
      <td>PETS AND SUPPLIES</td>
      <td>3300</td>
    </tr>
  </tbody>
</table>
</div>

<p><strong>In [180]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#getting data</span>
<span class="n">dat</span><span class="p">[[</span><span class="s">'TripType'</span><span class="p">,</span><span class="s">'Upc'</span><span class="p">]]</span>
<span class="n">dat</span><span class="p">[</span><span class="s">'ScanCount'</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">1</span>
<span class="n">dat</span><span class="p">[</span><span class="n">dat</span><span class="p">[</span><span class="s">'ScanCount'</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">]</span></code></pre></figure>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TripType</th>
      <th>VisitNumber</th>
      <th>Weekday</th>
      <th>Upc</th>
      <th>ScanCount</th>
      <th>DepartmentDescription</th>
      <th>FinelineNumber</th>
      <th>foo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2238403510</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>3565</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2006613744</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>1017</td>
      <td>spam</td>
    </tr>
    <tr>
      <th>5</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2006618783</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>1017</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>88679300501</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>3504</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2238400200</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>3565</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>18</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>25541500000</td>
      <td>2</td>
      <td>DAIRY</td>
      <td>1305</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<p><strong>In [33]:</strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># as promised, .add with fill</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">Series</span><span class="p">([</span><span class="mi">35000</span><span class="p">,</span><span class="mi">71000</span><span class="p">,</span><span class="mi">16000</span><span class="p">,</span><span class="mi">5000</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'Ohio'</span><span class="p">,</span><span class="s">'Texas'</span><span class="p">,</span><span class="s">'Oregon'</span><span class="p">,</span><span class="s">'Utah'</span><span class="p">])</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'Ohio'</span><span class="p">,</span><span class="s">'Texas'</span><span class="p">,</span><span class="s">'Oregon'</span><span class="p">,</span><span class="s">'Ontario'</span><span class="p">])</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">"pop"</span><span class="p">])</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">"pop"</span><span class="p">])</span>
<span class="n">l</span><span class="o">+</span><span class="n">k</span>
<span class="n">l</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code></pre></figure>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>70000</td>
    </tr>
    <tr>
      <th>Ontario</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>32000</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>142000</td>
    </tr>
    <tr>
      <th>Utah</th>
      <td>5000</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="summary">Summary</h3>

<p>That’s it for today.</p>

<p>Next lesson we will cover in more detail how to read in and clean data, as well
as merging, and the split, apply, combine methods on DataFrames.</p>

<h3 id="exercises">Exercises</h3>

<p>1. Create an array of size 10, with all 0s</p>

<p>2. Reshape the above vector to have dims of (5,2)</p>

<p>3. Create a 4*4 identity matrix in NumPy (use google or the docs for a
function)</p>

<p>4. Create a 10 by 10 matrix or random values (randn, mean = 3), and find the
minimum and maximum values. Find the index of these values</p>

<p>5. Normalise the above matrix to have a mean of 0</p>

<p>6. Create a Series, which has an index of NY, SF, TO, and CH, and the values
0.2, 0.9, 3.5 and 2.4</p>

<p>7. Reindex this series to include VA with NA</p>

<p>8. Add the two above Series, correcting for NaN</p>

  </div>
  
      <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'jeremycg';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

  
</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Python @ Precima</h2>



  </div>

</footer>


  </body>

</html>
